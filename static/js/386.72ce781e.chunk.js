"use strict";(self.webpackChunkfront_end=self.webpackChunkfront_end||[]).push([[386],{2167:(e,t,a)=>{a.d(t,{A:()=>A});var s=a(5043),n=a(3709),o=a(4177),r=a(9652),l=a(6955),c=a(7200),i=a(8802),u=a(5881),d=a(9912),g=a(3003),h=a(7198),p=a(1072),m=a(8602),j=a(6690),y=a(246),f=a(3910),x=a(7929),v=a(6178),b=a.n(v),N=a(579);const A=()=>{const[e,t]=(0,s.useState)(),a=(0,g.d4)((e=>e.user.idUser)),v=(0,g.d4)((e=>e.user.role)),A=(0,n.Zp)(),[D,S]=(0,s.useState)(!1),[C,k]=(0,s.useState)(""),[P,w]=(0,s.useState)([]),[T,I]=(0,s.useState)(""),[$,z]=(0,s.useState)(""),[G,O]=(0,s.useState)(""),[L,q]=(0,s.useState)(""),[M,B]=(0,s.useState)(""),[H,Y]=(0,s.useState)([]),[F,U]=(0,s.useState)([]),[E,Q]=(0,s.useState)(""),[_,K]=(0,s.useState)(v&&"partner"===v?{page:1,count:20,searchStatus:"",projectName:"",searchDate:"",searchContent:"",typeOfDonation:""}:{page:1,count:20,searchStatus:"",projectName:"",searchDate:"",searchContent:"",typeOfDonation:"",organization:""}),[R,X]=(0,s.useState)(0),[Z,V]=(0,s.useState)(null),[J,W]=(0,s.useState)(null);async function ee(){let e,s;if("partner"===v){const e={page:_.page,count:_.count,status:_.searchStatus,searchDate:_.searchDate,searchContent:_.searchContent,typeOfDonation:_.typeOfDonation,projectName:_.projectName,organizationId:a};s="?"+y.A.stringify(e)}else if("admin 1"===v||"admin 2"===v){const e={page:_.page,count:_.count,status:_.searchStatus,searchDate:_.searchDate,searchContent:_.searchContent,typeOfDonation:_.typeOfDonation,projectName:_.projectName,organization:_.organization};s="?"+y.A.stringify(e)}console.log(s),e=await l.A.getDonationList(s),e&&!0===e.success?(t(e.donationList),X(Math.ceil(e.totalCount/_.count))):!e||500!==e.status&&404!==e.status||A("/error-page",{state:{status:e.status,errors:e.errors}})}(0,s.useEffect)((()=>{v&&ee()}),[_]),(0,s.useEffect)((()=>{v&&"partner"===v&&a?async function(e){console.log("projectlist");const t=await c.A.getProjectList(e);if(console.log("response"),t&&!0===t.success){console.log("success");const e=t.projectList.map((e=>({value:e._id,label:e.title})));e.unshift({value:"",label:"D\u1ef1 \xe1n"}),Y(e)}else!t||500!==t.status&&404!==t.status||A("/error-page",{state:{status:t.status,errors:t.errors}})}(a):!v||"admin 1"!==v&&"admin 2"!==v||(async function(){console.log("projectlist");const e=await c.A.getAllProjectList();if(console.log("response"),e&&!0===e.success){console.log("success");const t=e.projectList.map((e=>({value:e._id,label:e.title})));t.unshift({value:"",label:"D\u1ef1 \xe1n"}),Y(t)}else!e||500!==e.status&&404!==e.status||A("/error-page",{state:{status:e.status,errors:e.errors}})}(),async function(){console.log("org");const e=await i.A.getOrganizationList();if(console.log("response"),e&&!0===e.success){console.log("success");const t=e.organizationList.map((e=>({value:e._id,label:e.organizationName})));t.unshift({value:"",label:"T\u1ed5 ch\u1ee9c"}),U(t)}else!e||500!==e.status&&404!==e.status||A("/error-page",{state:{status:e.status,errors:e.errors}})}())}),[a]);const te=()=>{S(!1)};return(0,N.jsxs)(r.A,{formName:"donation-management",children:[(0,N.jsxs)(p.A,{className:"filter-container justify-content-sm-start justify-content-md-between align-items-center",children:[(0,N.jsxs)(m.A,{className:"filter-options row justify-content-start mb-0 col-auto",children:[v&&("admin 1"===v||"admin 2"===v)&&(0,N.jsx)(h.A,{value:E,type:"select",id:"organizationName",name:"organizationName",sharedName:"col-auto",className:"filter-control search-project",onChange:e=>{Q(e.target.value),K((t=>({...t,organization:e.target.value})))},options:F}),(0,N.jsx)(h.A,{value:M,type:"select",id:"projectName",name:"projectName",sharedName:"col-auto",className:"filter-control search-project",onChange:e=>{B(e.target.value),K((t=>({...t,projectName:e.target.value})))},placeholder:"T\xecm ki\u1ebfm d\u1ef1 \xe1n",options:H}),(0,N.jsx)(h.A,{value:T,type:"select",id:"status",name:"status",sharedName:"col-auto",className:"filter-control search-status ",onChange:e=>{I(e.target.value),K((t=>({...t,searchStatus:e.target.value})))},options:[{value:"",label:"Tr\u1ea1ng th\xe1i"},{value:"pending",label:"Ch\u1edd duy\u1ec7t"},{value:"confirm",label:"\u0110\xe3 nh\u1eadn"},{value:"reject",label:"T\u1eeb ch\u1ed1i"}]}),(0,N.jsx)(h.A,{value:$,type:"date",id:"searchDate",name:"searchDate",sharedName:"col-auto",className:"filter-control search-date",onChange:e=>{const t=e.target.value,a=b()(t).format("YYYY-MM-DD");z(t),K((e=>({...e,searchDate:a})))}}),(0,N.jsx)(h.A,{value:L,type:"select",id:"typeOfDonation",name:"typeOfDonation",sharedName:"col-auto",className:"filter-control search-type",onChange:e=>{q(e.target.value),K((t=>({...t,typeOfDonation:e.target.value})))},options:[{value:"",label:"Quy\xean g\xf3p"},{value:"money",label:"Ti\u1ec1n"},{value:"clothes",label:"Qu\u1ea7n \xe1o"},{value:"book",label:"S\xe1ch"}]})]}),(0,N.jsx)(m.A,{className:"search-bar justify-content-xl-end justify-content-start col-auto ",children:(0,N.jsxs)("div",{className:"search-input-container",children:[(0,N.jsx)(f.g,{icon:x.$UM,className:"search-icon"}),(0,N.jsx)(h.A,{value:G,type:"text",id:"searchContent",name:"searchContent",className:"search-input",placeholder:"T\xecm ki\u1ebfm",onChange:e=>{O(e.target.value),K((t=>({...t,searchContent:e.target.value})))}})]})})]}),v&&"partner"===v&&(0,N.jsx)(o.A,{title:"DANH S\xc1CH QUY\xcaN G\xd3P",type:"donation",detail:e,actionHandler:(e,t,a,s)=>{k(e),w(t),S(!0),V(a),W(s)},onOpen:e=>{S(!0)},className:"donation-list",selectedIDs:P,role:"partner"}),v&&("admin 1"===v||"admin 2"===v)&&(0,N.jsx)(o.A,{title:"DANH S\xc1CH QUY\xcaN G\xd3P",type:"donation",detail:e,className:"donation-list",selectedIDs:P,role:v}),(0,N.jsx)(j.A,{pagination:_,handlerChangePage:e=>{K((t=>({...t,page:e})))},totalPage:R}),(0,N.jsx)(p.A,{children:(0,N.jsx)(u.A,{isOpen:D,onClose:te,children:(0,N.jsx)(d.A,{action:C,registered:Z||"",typeOfDona:J||"",onClose:te,selectedIDs:P,onBulkConfirm:async(e,t)=>{const a=await l.A.updateDonation({donationIds:e,action:t});a&&!0===a.success?(window.alert("X\xe1c nh\u1eadn th\xe0nh c\xf4ng!"),ee()):a&&400===a.status?window.alert(a.errors):!a||500!==a.status&&404!==a.status||A("/error-page",{state:{status:a.status,errors:a.errors}}),console.log("X\xe1c nh\u1eadn c\xe1c ID:",e)},onBulkReject:async(e,t,a)=>{const s=await l.A.updateDonation({donationIds:e,action:t,reasonForRejection:a});s&&!0===s.success?(window.alert("T\u1eeb ch\u1ed1i th\xe0nh c\xf4ng!"),ee()):!s||500!==s.status&&404!==s.status||A("/error-page",{state:{status:s.status,errors:s.errors}}),console.log("T\u1eeb ch\u1ed1i c\xe1c ID:",e)},onCorrect:async(e,t,a)=>{const s=await l.A.updateDonation({donationIds:e,action:t,exact:a});s&&!0===s.success?(window.alert("\u0110\xednh ch\xednh th\xe0nh c\xf4ng"),ee()):!s||500!==s.status&&404!==s.status||A("/error-page",{state:{status:s.status,errors:s.errors}}),console.log("\u0110\xednh ch\xednh c\xe1c ID:",e)}})})})]})}},6690:(e,t,a)=>{a.d(t,{A:()=>l});a(5043);var s=a(579);function n(e){const{indexPage:t,handlerChangePage:a,pagination:n}=e,{page:o}=n;return console.log(t),(0,s.jsx)("div",{className:"d-flex ",children:t&&t.map((e=>(0,s.jsx)("li",{className:e===parseInt(o)?"page-item active ":"page-item",onClick:()=>(e=>{a&&a(e)})(e),children:(0,s.jsx)("a",{className:"page-link",children:e})},e)))})}n.defaultProps={indexPage:null,handlerChangePage:null,pagination:{}};const o=n;function r(e){const{pagination:t,handlerChangePage:a,totalPage:n}=e;console.log(n);const{page:r}=t;let l=[];for(var c=1;c<=n;c++)l.push(c);return(0,s.jsxs)("nav",{"aria-label":"Page navigation example",className:"pt-5",children:[(0,s.jsxs)("ul",{className:"pagination justify-content-center justify-content-lg-end",children:[(0,s.jsx)("li",{className:"page-item",children:(0,s.jsx)("button",{className:"page-link",onClick:()=>(e=>{if(!a)return;const t=parseInt(e)-1;a(t)})(r),disabled:r<=1,children:(0,s.jsx)("span",{children:"\xab"})})}),(0,s.jsx)(o,{indexPage:l,handlerChangePage:a,pagination:t}),(0,s.jsx)("li",{className:"page-item",children:(0,s.jsx)("button",{className:"page-link",onClick:()=>(e=>{if(!a)return;const t=parseInt(e)+1;a(t)})(r),disabled:r>=n,children:(0,s.jsx)("span",{children:"\xbb"})})})]}),(0,s.jsx)("div",{className:"pagination justify-content-center justify-content-lg-end",children:(0,s.jsxs)("p",{className:"text-small text-muted mb-0",children:["Showing 1\u201310 of ",10*parseInt(n)," results"]})})]})}r.defaultProps={pagination:{},handlerChangePage:null,totalPage:null};const l=r},6955:(e,t,a)=>{a.d(t,{A:()=>n});var s=a(5304);const n={submitDonationInfo:(e,t)=>{const a=`/projects/${e}/donate`;return s.A.post(a,t)},getDonationList:e=>{const t=`/admin/get/all-donation/${e}`;return s.A.get(t)},updateDonation:e=>s.A.put("/admin/donations",e),searchStatus:e=>{const t=`/admin/donation${e}`;return s.A.post(t)},deleteDonationInfo:e=>{const t=`/projects/donations/${e}`;return s.A.delete(t)}}},7200:(e,t,a)=>{a.d(t,{A:()=>n});var s=a(5304);const n={postProjectForm:e=>s.A.post("/admin/project-form",e),getDonationListByProjectId:(e,t)=>{const a=`/projects/${e}/donations${t}`;return s.A.get(a)},getDonationByName:(e,t)=>{const a=`/projects/${e}/donationByName${t}`;return s.A.get(a)},getProjectDetail:e=>{const t=`/projects/${e}`;return s.A.get(t)},getProjectDetailFormToEdit:e=>{const t=`/projects/edit/${e}`;return s.A.get(t)},updateProjectDetail:(e,t)=>{const a=`/projects/update/${e}`;return s.A.post(a,t)},getProjectList:e=>{const t=`/admin/projects/${e}`;return s.A.get(t)},getAllProjectList:()=>s.A.get("/projects/all"),getActiveProjects:()=>s.A.get("/projects/active"),getInactiveProjects:()=>s.A.get("/projects/inactive")}},7312:(e,t,a)=>{a.d(t,{A:()=>g});var s=a(5043),n=(a(646),a(3709)),o=a(7200),r=a(7198),l=a(9652);const c=function(e){const t=new Date(e);return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`};var i=a(3003),u=a(1072),d=a(579);const g=()=>{const e=(0,n.Zp)(),[t,a]=(0,s.useState)(null),[g,h]=(0,s.useState)(!1),{projectId:p}=(0,n.g)(),[m,j]=(0,s.useState)(""),[y,f]=(0,s.useState)(""),[x,v]=(0,s.useState)(!1),[b,N]=(0,s.useState)(!1),[A,D]=(0,s.useState)(!1),[S,C]=(0,s.useState)(),[k,P]=(0,s.useState)(),[w,T]=(0,s.useState)(),[I,$]=(0,s.useState)(""),[z,G]=(0,s.useState)(""),[O,L]=(0,s.useState)(""),[q,M]=(0,s.useState)(""),B=(0,i.d4)((e=>e.user.role)),H=(0,i.d4)((e=>e.user.idUser));return(0,s.useEffect)((()=>{p&&H&&async function(t){console.log("this step");const a=await o.A.getProjectDetailFormToEdit(t);if(a&&!0===a.success){const e=a.project;console.log(e),j(e.title||""),f(e.content||"");for(let a=0;a<e.types.length;a++)"money"===e.types[a]&&v(!0),"clothes"===e.types[a]&&N(!0),"book"===e.types[a]&&D(!0);for(let a=0;a<e.goals.length;a++)"money"===e.goals[a].form&&C(e.goals[a].goal),"clothes"===e.goals[a].form&&P(e.goals[a].goal),"book"===e.goals[a].form&&T(e.goals[a].goal);M(e.status),$(e.category||"");const t=e.deadline?c(e.deadline):"";G(t),a.organizationName&&L(a.organizationName.organizationName)}else!a||500!==a.status&&404!==a.status||e("/error-page",{state:{status:a.status,errors:a.errors}})}(p)}),[p,H]),(0,d.jsxs)(l.A,{formName:"layout-form ",formTitle:"BI\u1ec2U M\u1eaaU VI\u1ebeT D\u1ef0 \xc1N",errorMessage:t,children:[(0,d.jsxs)("form",{encType:"multipart/form-data",method:"POST",onSubmit:async t=>{t.preventDefault(),a("");const s=new FormData(t.target);console.log(s);const n=Object.fromEntries(s.entries());if(p){const t=await o.A.updateProjectDetail(p,s);t&&!0===t.success?(window.alert("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng"),h(!0)):!t||500!==t.status&&404!==t.status||e("/error-page",{state:{status:t.status,errors:t.errors}})}const r=s.getAll("donationType");if(r.includes("money")&&""===n.moneyGoal||!r.includes("money")&&""!==n.moneyGoal||r.includes("clothes")&&""===n.clothesGoal||!r.includes("clothes")&&""!==n.clothesGoal||r.includes("book")&&""===n.bookGoal||!r.includes("book")&&""!==n.bookGoal)a("M\u1ee5c ti\xeau quy\xean g\xf3p v\xe0 H\xecnh th\u1ee9c quy\xean g\xf3p ch\u01b0a kh\u1edbp!");else if(0===r.length)a("B\u1ea1n c\u1ea7n ch\u1ecdn h\xecnh th\u1ee9c quy\xean g\xf3p cho d\u1ef1 \xe1n");else{a(""),console.log(n);const t=await o.A.postProjectForm(s);t&&!0===t.success?(window.alert("B\u1ea1n \u0111\xe3 t\u1ea1o d\u1ef1 \xe1n th\xe0nh c\xf4ng!"),h(!0)):!t||500!==t.status&&404!==t.status||e("/error-page",{state:{status:t.status,errors:t.errors}})}},children:[(0,d.jsxs)("div",{className:"row",children:[(0,d.jsxs)("div",{className:"col-sm-6 pt-3 column-1",children:["admin"===B&&(0,d.jsx)(r.A,{label:"T\xean t\u1ed5 ch\u1ee9c:",type:"text",id:"organizationName",name:"organizationName",value:O,onChange:e=>L(e.target.value),required:!0}),(0,d.jsx)(r.A,{label:"Ti\xeau \u0111\u1ec1 d\u1ef1 \xe1n:",type:"text",id:"projectTitle",name:"title",value:m,onChange:e=>j(e.target.value),required:!0}),(0,d.jsx)(r.A,{label:"N\u1ed9i dung",type:"textarea",id:"projectContent",name:"content",rows:"10",value:y,onChange:e=>f(e.target.value),required:!0})]}),(0,d.jsxs)("div",{className:"col-sm-6 pt-3 column-2",children:[(0,d.jsxs)("h6",{children:["H\xecnh th\u1ee9c quy\xean g\xf3p:",(0,d.jsx)("sup",{className:"text-danger",children:"*"})]}),(0,d.jsx)(r.A,{label:"Ti\u1ec1n",type:"checkbox",id:"money",name:"donationType",sharedName:"donationType",value:"money",checked:x,onChange:e=>v(e.target.checked),disabled:p&&!0}),(0,d.jsx)(r.A,{label:"Qu\u1ea7n \xe1o",type:"checkbox",id:"clothes",name:"donationType",sharedName:"donationType",value:"clothes",checked:b,onChange:e=>N(e.target.checked),disabled:p&&!0}),(0,d.jsx)(r.A,{label:"S\xe1ch",type:"checkbox",id:"books",name:"donationType",sharedName:"donationType",value:"book",checked:A,onChange:e=>D(e.target.checked),disabled:p&&!0}),(0,d.jsxs)("h6",{children:["M\u1ee5c ti\xeau quy\xean g\xf3p:",(0,d.jsx)("sup",{className:"text-danger",children:"*"})]}),(0,d.jsxs)(u.A,{className:"ms-1",children:[(0,d.jsx)(r.A,{label:"Ti\u1ec1n",type:"number",id:"moneyGoal",name:"moneyGoal",sharedName:"goal col-md-2 px-0",min:"0",value:S,disabled:p&&!0}),(0,d.jsx)(r.A,{label:"S\xe1ch",type:"number",id:"bookGoal",name:"bookGoal",min:"0",sharedName:"goal col-md-2 px-0",value:w,disabled:p&&!0}),(0,d.jsx)(r.A,{label:"Qu\u1ea7n \xe1o",type:"number",id:"clothesGoal",name:"clothesGoal",min:"0",sharedName:"goal col-md-2 px-0",value:k,onChange:e=>P(e.target.value),disabled:p&&!0})]}),(0,d.jsx)(r.A,{label:"L\u0129nh v\u1ef1c",type:"select",id:"category",name:"category",sharedName:"category",value:I,onChange:e=>$(e.target.value),options:[{value:"education",label:"Gi\xe1o d\u1ee5c"},{value:"children",label:"Tr\u1ebb em"},{value:"medical",label:"Y t\u1ebf"},{value:"environment",label:"M\xf4i tr\u01b0\u1eddng"}],required:!0}),(0,d.jsx)(r.A,{label:"H\u1ea1n cu\u1ed1i:",type:"date",id:"deadline",name:"deadline",className:"form-control",sharedName:"deadline",value:z,onChange:e=>G(e.target.value),disabled:p&&"partner"===B,required:!0}),(0,d.jsx)(r.A,{label:"T\u1ea3i \u1ea3nh:",type:"file",id:"upload",name:"images",sharedName:"images",multiple:!0,required:!p}),p&&(0,d.jsx)(r.A,{label:"Tr\u1ea1ng th\xe1i",type:"select",id:"status",name:"status",sharedName:"status",value:q,onChange:e=>M(e.target.value),options:[{value:"\u0110ang k\xeau g\u1ecdi",label:"\u0110ang k\xeau g\u1ecdi"},{value:"K\u1ebft th\xfac",label:"K\u1ebft th\xfac"}],disabled:"partner"===B&&"K\u1ebft th\xfac"===q,required:!0})]})]}),(0,d.jsx)("p",{children:(0,d.jsxs)("small",{children:[(0,d.jsx)("span",{children:"L\u01b0u \xfd:"})," M\u1ee5c (",(0,d.jsx)("span",{className:"text-danger",children:"*"}),"): kh\xf4ng \u0111\u01b0\u1ee3c \u0111\u1ec3 tr\u1ed1ng."]})}),(0,d.jsx)("div",{className:"container-button",children:(0,d.jsx)("button",{type:"submit",className:"btn btn-success text-center",children:"Submit"})})]}),p&&g&&(0,d.jsx)(n.C5,{to:`/projects/${p}`}),g&&!p&&(0,d.jsx)(n.C5,{to:"/projects"})]})}}}]);
//# sourceMappingURL=386.72ce781e.chunk.js.map